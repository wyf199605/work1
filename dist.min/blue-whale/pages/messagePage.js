define(["require","exports"],function(e,a){"use strict";var d=G.localMsg,o=BW.sys,c=G.d;function u(e,a){0<a?(e.classList.remove("hide"),e.textContent=a):e.classList.add("hide")}return function(s){this.para=s;var r=document.querySelector("ul.mui-table-view"),l=document.querySelector("[data-field=badge]");function a(e,a){var t,i=e.length,n=0;a||(r.innerHTML="",0===i&&r.appendChild(c.create('<li class="nodata"><span class="iconfont icon-gongyongwushuju"></span></li>')));for(var s=0;s<i;s++)t="",t+='<li class="mui-table-view-cell"><div class="mui-slider-right mui-disabled" data-action="del"><a class="mui-btn mui-btn-red">删除</a></div><div class="mui-slider-handle inner-padding-row"><div data-action="read" data-url="'+e[s].content.link+'" class="mui-slider-handle" data-notify-id="'+e[s].notifyId+'"><a href="#msgDetail">',0===e[s].isread&&(t+='<span class="mui-badge badge-dot mui-badge-primary unread"></span>',n++),t+='<h5><span data-field="sender">'+e[s].sender+'</span> <span class="mui-h5 pull-right"><span data-field="createDate">'+e[s].createDate+'</span><span class="mui-icon mui-icon-arrowright"></span></span></h5>',t+='<p class="mui-h6 ellipsis-row2" data-field="content">'+e[s].content.content+"</p>",t+="</a></div></div></li>",a?r.insertBefore(c.create(t),r.firstChild):r.appendChild(c.create(t));if(a){var d=parseInt(l.textContent);u(l,d+n)}else u(l,n)}console.log(d.get()),a(d.get(),!1),c.on(r,"click","[data-action]",function(){switch(this.dataset.action){case"read":null!==(n=(i=this).querySelector(".mui-badge.unread"))&&(i.querySelector("a[href]").removeChild(n),d.read(i.dataset.notifyId),u(l,parseInt(l.textContent)-1)),o.window.open({url:s.mgrPath+this.dataset.url});break;case"del":var e=this.parentElement;c.remove(e);var a=c.query("[data-notify-id]",e),t=void 0;a&&(t=a.dataset.notifyId),d.remove(parseInt(t))}var i,n}),window.addEventListener("newMsg",function(e){a(JSON.parse(e.detail),!0)}),o.window.close=double_back}});