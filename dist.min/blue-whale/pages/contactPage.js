define(["require","exports","BasicPage","BwRule","Modal","PopMenu","InputBox","Button"],function(t,e,n,l,i,r,a,s){"use strict";var u=BW.sys,c=G.d,d=G.tools,p=BW.CONF;return function(o){function t(e){var t=o.call(this,e)||this;t.para=e;var a=t;if(a.isMb&&c.on(c.query(".mui-table-view"),"press",".col-content",function(){var t=[],n=this;if(t.push("复制"),"MOBILE"===n.dataset.col&&(t.push("拨号"),t.push("短信")),0<t.length){var a=new r.PopMenu({arr:t,callback:function(t,e){"复制"===t.innerHTML?u.window.copy(n.textContent):"拨号"===t.innerHTML?u.window.load("tel:"+n.textContent):"短信"===t.innerHTML&&u.window.load("sms:"+n.textContent),a.destroy()}}),e=n.getBoundingClientRect(),o=n.offsetWidth/2,l=e.left,i=e.top;a.show(i,o+l)}}),0===e.keyField.length)i.Modal.alert("keyField 为空");else{var n=d.url.getPara("userid",t.url);l.BwRule.Ajax.fetch(p.ajaxUrl.myself,{data:n?{userid:n}:null}).then(function(t){var n=t.response;(u.isMb?c.queryAll(".mui-table-view-cell [data-col]"):c.queryAll(".list-group-item [data-col]",e.dom)).forEach(function(t){var e=n.data[0][t.dataset.col];null==e?c.remove(t.parentElement.parentElement):t.innerHTML=e}),d.isMb&&a.btnInit()})}return t}return __extends(t,o),t.prototype.btnInit=function(){var t=new a.InputBox({container:this.para.wrapper,size:"middle",compactWidth:1,className:"button-call"}),e=c.query('[data-col="MOBILE"]');e.textContent&&(t.addItem(new s.Button({content:"拨号",icon:"call",className:"call",onClick:function(){u.window.load("tel:"+e.textContent)}})),t.addItem(new s.Button({content:"短信",icon:"xiaoxi",className:"xiaoxi",onClick:function(){u.window.load("sms:"+e.textContent)}}))),t.addItem(new s.Button({content:"邮件",icon:"message",className:"message",onClick:function(){var t=c.query('[data-col="USERID"]').textContent;BW.sys.window.open({url:d.url.addObj(BW.CONF.url.mail,{defaultvalue:'{"RECEIVERID":"'+t+'"}'})})}}))},t}(n.default)});