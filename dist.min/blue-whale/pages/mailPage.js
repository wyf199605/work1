define("MailPage",["require","exports","Mail","Modal","BwRule","FastTable","newTableModule","BasicPage"],function(e,t,o,a,r,c,m,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=G.tools,b=G.d,i=function(u){function e(e){var t=u.call(this,e)||this;t.para=e,t.wrapper=h("div",{className:"mail-wrapper"}),e.dom.classList.add("mail-container"),b.append(e.dom,t.wrapper);var a=e.ui.body;if(a.elements[0]&&delete a.elements[0].tableAddr,Array.isArray(a.subButtons)&&a.elements[0]){var l=a.elements[0].subButtons;a.elements[0].subButtons=Array.isArray(l)?l:[],a.subButtons.forEach(function(e){a.elements[0].subButtons.push(e)})}for(var i=0,n=a.elements[0].cols;i<n.length;i++){var s=n[i];"READSTATE"===s.name?s.noShow=!0:p.isNotEmpty(s.link)&&delete s.link}t.tableModule=new m.NewTableModule({bwEl:a.elements[0],container:t.wrapper});var o=t.tableModule.main.ftable,r=o.pseudoTable,d=t;return o.click.add(".section-inner-wrapper tbody tr[data-index]",function(){var e=parseInt(this.dataset.index);o.rowGet(e)&&(r&&r.setPresentSelected(e),d.initMail(e,o.data))}),o.on(c.FastTable.EVT_RENDERED,function(){try{0<o.data.length&&(r&&r.setPresentSelected(0),o.rows[0]&&(o.rows[0].selected=!0),o._drawSelectedCells(),d.initMail(0,o.data))}catch(e){}}),t}return __extends(e,u),e.prototype.initModal=function(e){return new a.Modal({body:e,position:"right",fullPosition:"fixed",container:this.para.dom,isBackground:!1,className:"modal-mail",isAnimate:!0,isShow:!0,width:"400px",top:50,header:{title:"详情",isFullScreen:!0},isDrag:!0,isOnceDestroy:!0})},e.prototype.initMail=function(e,t){var a=this,l=h("div",{className:"mail-body"}),i=this.tableModule.main.ftable,n=i.pseudoTable,s=i.columnGet("READSTATE").content.link;this.modal&&this.modal.isShow?this.modal.body=l:this.modal=this.initModal(l),this.mail=new o.Mail({link:r.BwRule.reqAddr(s,t[e]),index:e,container:l,modal:this.modal,table:this.tableModule.main,onChange:function(e){i._clearAllSelectedCells(),n&&n.setPresentSelected(e),i.rows[e]&&(i.rows[e].selected=!0),i._drawSelectedCells(),a.initMail(e,t)}})},e}(l.default);t.MailPage=i});