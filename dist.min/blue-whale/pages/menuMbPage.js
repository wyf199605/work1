define(["require","exports","menuMrg","BwRule","Search"],function(e,t,a,n,i){"use strict";var s=BW.sys,r=G.tools,d=BW.CONF,o=G.d;function l(e,t){0<t?(e.classList.remove("hide"),e.textContent=t):e.classList.add("hide")}return function(e){this.para=e,o.on(o.query("#list"),"click","li.mui-table-view-cell[data-href]",function(){s.window.open({url:d.siteUrl+this.dataset.href,gps:!!parseInt(this.dataset.gps)})}),o.on(o.query("#list"),"press","li.mui-table-view-cell",function(){var e=r.isEmpty(this.dataset.favid)?"add":"cancel";a.MENU_FAVORITE.toggleFavSheet(this,e,{favid:this.dataset.favid,link:this.dataset.href})}),function(){var e=document.querySelectorAll('.mui-badge:not([data-url=""])');function t(e){for(var t=0,a=e.length;t<a;t++)!function(a){n.BwRule.Ajax.fetch(d.siteUrl+a.dataset.url).then(function(e){var t=e.response;void 0!==t.data[0].N&&l(a,parseInt(t.data[0].N))})}(e[t])}t(e),window.addEventListener("refreshBadge",function(){t(e)})}(),window.addEventListener("wake",function(){o.queryAll('.mui-badge:not([data-url=""])').forEach(function(a){n.BwRule.Ajax.fetch(d.siteUrl+a.dataset.url).then(function(e){var t=e.response;void 0!==t.data[0].N&&l(a,parseInt(t.data[0].N))})})}),new i.Search({nodeId:e.nodeId,baseUrl:e.baseUrl,searchBtn:e.searchBtn})}});