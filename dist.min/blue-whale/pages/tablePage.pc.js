define("TablePage",["require","exports","BwRule","Button","BasicPage"],function(u,e,b,d,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=G.d,c=BW.CONF,f=BW.sys,a=function(a){function e(e,r){var i=a.call(this,e)||this;i.para=e;var s=i.para.mtPara;if(G.tools.isEmpty(s.cols)){var t=BW.sys.isMb?"QueryModuleMb":"QueryModulePc";u([t],function(e){var l=!0,t=o.closest(f.isMb?i.para.tableDom:i.para.dom,".page-container"),u=new e({qm:s,refresher:function(a,o,n){var e=c.siteUrl+b.BwRule.reqAddr(s.uiPath);a.output="json",b.BwRule.Ajax.fetch(G.tools.url.addObj(e,a),{timeout:3e4,defaultCallback:!1,needGps:s&&s.uiPath&&!!s.uiPath.needGps}).then(function(e){var t=e.response;delete a.output,i.tableModule&&i.tableModule.destroy(),i.tableModule=null,i.para.tableDom=null;i.requireTable(t.body.elements[0],a,function(){f.isMb||(l&&u.toggleCancle(),i.tableModule.rightBtns.add(new d.Button({content:"查询器",type:"default",icon:"shaixuan",onClick:function(){u.show()}}))),l=!1,"function"==typeof r&&r(),i.tableModule.tableData.cbFun.setOuterAfter(o),i.tableModule.tableData.cbFun.setOuterBefore(n)})}).catch(function(){})},cols:[],url:null,container:t,tableGet:function(){return null}});if(!f.isMb&&u.toggleCancle(),f.isMb&&o.on(o.query('body > header [data-action="showQuery"]'),"click",function(){u.show()}),s.asynData){var a={query:u,qm:s,container:t};i.asynQuery(a)}})}else i.requireTable(s,null,r);return i}return __extends(e,a),e.prototype.requireTable=function(a,o,n){var l=this;b.BwRule.beforeHandle.table(a);var e=this.isMb?"TableModuleMb":"TableModulePc";u([e],function(e){l.initTable(e,a,o);var t=l.tableModule;l.on(b.BwRule.EVT_REFRESH,function(){t&&t.refresher(null,function(){t.aggregate.get()})}),l.on("table-data-add",function(e){l.tableModule.editBtns.edit(),setTimeout(function(){l.tableModule.table.copy.match(e.detail).forEach(function(e){l.tableModule.tableEdit.add(e)})},800)}),"function"==typeof n&&n()})},e.prototype.asynQuery=function(t){var a=this;u(["AsynQuery"],function(e){new e.AsynQuery(G.tools.obj.merge(a.para,{asynData:t}))})},e}(t.default);e.TablePage=a}),define("TablePagePc",["require","exports","BwRule","TablePage"],function(e,t,u,a){"use strict";var n=G.d;return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.initTable=function(e,t,a){var o=this;this.addConf(t),this.para.tableDom=n.create('<table class="mobileTable"><tbody></tbody></table>'),this.para.dom.appendChild(this.para.tableDom),this.tableModule=new e({tableEl:this.para.tableDom,scrollEl:this.dom.parentElement,fixTop:40,ajaxData:a},t),this.on("wake",function(){o.tableModule.table&&o.tableModule.table.resize(),o.tableModule.lockBottom(!0)})},t.prototype.addConf=function(e){var t=G.tools.isEmpty(e.subButtons)?[]:e.subButtons,a=G.tools.isEmpty(e.subTableList)?[]:e.subTableList;t&&(e.subButtons=t,this.para.bodySubButtons&&(e.subButtons=t.concat(this.para.bodySubButtons)));for(var o=0,n=a;o<n.length;o++){var l=n[o];u.BwRule.beforeHandle.table(l)}},t}(a.TablePage)});