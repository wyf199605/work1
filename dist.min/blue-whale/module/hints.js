define("Hints",["require","exports","Modal","InputBox","Button","Tab","BwRule"],function(t,n,i,s,d,r,u){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var l=G.d,h=BW.sys,c=BW.CONF,a=function(){function t(t){this.index=0,this.ajax=new u.BwRule.Ajax,this.init(t)}return t.prototype.init=function(t){var n=this,a=new s.InputBox,e=new s.InputBox;this.dataMap=t.data.dataMap,this.len=this.dataMap.length,this.upButton=new d.Button({content:"上一条",type:"primary",onClick:function(){n.ajaxLoad(n.index-1)}}),this.nextButton=new d.Button({content:"下一条",type:"primary",onClick:function(){n.ajaxLoad(n.index+1)}}),this.openButton=new d.Button({content:"打开",type:"primary",onClick:function(){var t=l.query(".tab-pane.active [data-url]",n.modal.bodyWrapper);h.window.open({url:c.siteUrl+t.dataset.url})}}),this.noWarmButton=new d.Button({content:"今日不提醒",type:"primary",onClick:function(t){u.BwRule.Ajax.fetch(c.siteUrl+t.target.dataset.url,{type:"POST"}).then(function(){n.noWarmButton.getDom().classList.add("disabled")})}}),e.addItem(this.openButton),e.addItem(this.noWarmButton),a.addItem(this.upButton),a.addItem(this.nextButton),this.modal=new i.Modal({header:"提醒",width:"600px",isBackground:!1,body:l.create('<div class="hints-body"></div>'),footer:{rightPanel:a,leftPanel:e}}),this.modal.onClose=function(){n.modal.destroy()};var o=[];t.data.dataMap.forEach(function(t){o.push({title:t.content.caption,dom:l.create('<div data-url="'+t.content.link+'">'+t.content+"</div>")})}),this.tab=new r.Tab({tabParent:this.modal.bodyWrapper,panelParent:this.modal.bodyWrapper,tabs:o,onClick:function(t){n.ajaxLoad(t)}}),this.ajaxLoad(this.index)},t.prototype.showMsg=function(t,n,a,e,o){0===t?this.upButton.getDom().classList.add("disabled"):this.upButton.getDom().classList.remove("disabled"),t===this.len-1?this.nextButton.getDom().classList.add("disabled"):this.nextButton.getDom().classList.remove("disabled"),e?(this.noWarmButton.getDom().classList.remove("disabled"),this.noWarmButton.getDom().dataset.url=e):this.noWarmButton.getDom().classList.add("disabled"),o?(this.noWarmButton.getDom().innerHTML=o,this.noWarmButton.getDom().classList.remove("hide")):this.noWarmButton.getDom().classList.add("hide"),this.index=t,this.tab.active(t);var i=l.query(".tab-pane.active [data-url]",this.modal.bodyWrapper);i.innerHTML=n,i.dataset.url=a,i.dataset.url?this.openButton.getDom().classList.remove("disabled"):this.openButton.getDom().classList.add("disabled")},t.prototype.destroy=function(){this.modal.destroy()},t.prototype.ajaxLoad=function(o){var i=this,t=this.dataMap[o].content.link;this.ajax.fetch(c.siteUrl+t,{type:"POST",cache:!0}).then(function(t){var n=t.response.body.elements[0],a=n.btnAddr&&n.btnAddr.dataAddr,e=n.openlink&&n.openlink.dataAddr||"";i.showMsg(o,n.textMsg,e,a,n.btnCaption)})},t}();n.Hints=a});