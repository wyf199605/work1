define("Gesture",["require","exports"],function(t,n){"use strict";var e=G.d;return function(){function t(t){this.GesturePara=t,this.initHtml(),this.initEvent()}return t.prototype.initHtml=function(){this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.canvas.width=window.screen.availWidth,this.canvas.height=window.screen.availHeight,this.canvas.style.background="rgba(0,0,0,0.3)",this.initIcon(),this.drawText("请绘制手势")},t.prototype.initIcon=function(){this.container=document.createElement("div"),this.container.setAttribute("style","z-index:1001; position:fixed;top:0px;");var t=document.createElement("i");t.setAttribute("style","z-index:-1;position:absolute; top:50%; left:50%; margin-top:0px; margin-left:-100px; font-size:200px; color:rgb(130,130,130);"),t.className="iconfont icon-gesture",this.container.appendChild(this.canvas),this.container.appendChild(t),this.GesturePara.container.appendChild(this.container)},t.prototype.initEvent=function(){var i=this;this.points=new Array,this.dollarRecognizer=new DollarRecognizer,this.ctx.fillStyle="rgb(0,0,225)",this.ctx.strokeStyle="rgb(0,0,225)",this.ctx.lineWidth=3,this.ctx.font="16px Gentilis",this.rect=this.getCanvasRect(),this.isDown=!1,e.on(this.canvas,"touchstart",function(t){var n=t.target;n.classList.contains("icon-quxiao")||n.classList.contains("icon-fasongyoujian")||i.mouseDownEvent(t.targetTouches[0].clientX,t.targetTouches[0].clientY)}),e.on(this.canvas,"touchmove",function(t){var n=t.target;n.classList.contains("icon-quxiao")||n.classList.contains("icon-fasongyoujian")||i.mouseMoveEvent(t.targetTouches[0].clientX,t.targetTouches[0].clientY),t.preventDefault(),t.stopPropagation()}),e.on(this.canvas,"touchend",function(t){var n=t.target;n.classList.contains("icon-quxiao")||n.classList.contains("icon-fasongyoujian")||i.mouseUpEvent(t.changedTouches[0].clientX,t.changedTouches[0].clientY),i.container.remove(),i.GesturePara.onFinsh.call(i,i.shape)})},t.prototype.getCanvasRect=function(){for(var t=this.canvas.width,n=this.canvas.height,i=this.canvas.offsetLeft,e=this.canvas.offsetTop;null!=this.canvas.offsetParent;)this.canvas=this.canvas.offsetParent,i+=this.canvas.offsetLeft,e+=this.canvas.offsetTop;return{x:i,y:e,width:t,height:n}},t.prototype.getScrollY=function(){return document.body.scrollTop},t.prototype.mouseDownEvent=function(t,n){document.onselectstart=function(){return!1},document.ontouchstart=function(){return!1},this.isDown=!0,t-=this.rect.x,n-=this.rect.y-this.getScrollY(),0<this.points.length&&this.ctx.clearRect(0,0,this.rect.width,this.rect.height),this.points.length=1,this.points[0]=new Point(t,n),this.ctx.fillRect(t-4,n-3,9,9)},t.prototype.mouseMoveEvent=function(t,n){this.isDown&&(t-=this.rect.x,n-=this.rect.y-this.getScrollY(),this.points[this.points.length]=new Point(t,n),this.drawConnectedPoint(this.points.length-2,this.points.length-1))},t.prototype.mouseUpEvent=function(t,n){if(document.onselectstart=function(){return!0},document.ontouchstart=function(){return!0},this.isDown)if(this.isDown=!1,10<=this.points.length){var i=this.dollarRecognizer.Recognize(this.points,!0);this.shape=i.Name}else this.shape="无法识别"},t.prototype.drawText=function(t){this.ctx.font="25px Arial";var n=this.ctx.measureText(t).width;this.ctx.fillText(t,this.canvas.width/2-n/2,this.canvas.height/2+150)},t.prototype.drawConnectedPoint=function(t,n){this.ctx.beginPath(),this.ctx.moveTo(this.points[t].X,this.points[t].Y),this.ctx.lineTo(this.points[n].X,this.points[n].Y),this.ctx.closePath(),this.ctx.stroke()},t.prototype.round=function(t,n){return n=Math.pow(10,n),Math.round(t*n)/n},t}()});