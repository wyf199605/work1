var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),$y;!function(t){var e=function(){function t(t){this.top=100,this._moveing=!1,this._scaleing=!1,t.top&&(this.top=t.top),this.$el="string"==typeof t.el?document.querySelector(t.el):t.el,this.$title="string"==typeof t.title?document.querySelector(t.title):t.title,this.$close="string"==typeof t.close?document.querySelector(t.close):t.close,this.$panel="string"==typeof t.panel?document.querySelector(t.panel):t.panel}return t}();t.AbstractModal=e}($y||($y={}));var $y;!function(t){t.Uitls={uuid:0,isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},mousedown:function(t,e,o){this[t](this.isMobile()?"touchstart":"mousedown",e,o)},mouseup:function(t,e,o){this[t](this.isMobile()?"touchend":"mouseup",e,o)},mousemove:function(t,e,o){this[t](this.isMobile()?"touchmove":"mousemove",e,o)},on:function(t,e,o){document.addEventListener&&e.addEventListener(t,o,!1)},off:function(t,e,o){document.removeEventListener&&e.removeEventListener(t,o,!1)},isMobile:function(){return"ontouchmove"in document},dragStart:function(){document.onselectstart=function(){return!1},document.ondragstart=function(){return!1}},dragStop:function(){document.onselectstart=null,document.ondragstart=null}}}($y||($y={}));var $y;!function(t){var e=function(e){function o(t){var o=e.call(this,t)||this;return o._bindEvent(),o}return __extends(o,e),o.prototype.isShow=function(){if(this.$el)return"none"!==this.$el.style.display},o.prototype.show=function(){var t=this;this.$el&&(this.$el.classList.add("y-modal"),this._setPosition(),this.$el.classList.remove("fade"),this.$el.style.display="block",this.$el.classList.add("y-modal-opening"),setTimeout(function(){t.$el.classList.remove("y-modal-opening")},500))},o.prototype.hide=function(){var t=this;this.$el&&(this.$el.classList.add("y-modal-closing"),setTimeout(function(){t.$el.classList.add("fade"),t.$el.style.display="none",t.$el.classList.remove("y-modal-closing")},450))},o.prototype._setPosition=function(){var t,e=this.$el,o="block"!=this.$el.style.display;o&&(this.$el.classList.remove("fade"),this.$el.style.display="block"),t=document.body.scrollWidth/2-e.getBoundingClientRect().width/2,o&&(this.$el.style.display="none",this.$el.classList.add("fade")),this.$el.style.top=this.top+"px",this.$el.style.left=(t<0?0:t)+"px"},o.prototype._getPanelInfo=function(){return this._panelInfo?this._panelInfo:this.$panel?this.$panel.getBoundingClientRect():{top:0,left:0,right:document.body.scrollWidth,bottom:document.body.scrollHeight}},o.prototype._getDragState=function(t,e,o){return!this._dragState||o?{startMouseTop:t.pageY,startMouseLeft:t.pageX,startTop:e.top+(document.documentElement.scrollTop||document.body.scrollTop||window.pageYOffset),startRight:e.left+e.width,startLeft:e.left+(document.documentElement.scrollLeft||document.body.scrollLeft||window.pageXOffset),startBottom:e.top+e.height,width:e.width,height:e.height}:this._dragState},o.prototype._mousedownHandle=function(e){var o=this,i=this.$el.getBoundingClientRect(),s=t.Uitls.isMobile()?e.targetTouches[0]:e,n=0,l=0,r=0,a=0;this._moveing=!0,t.Uitls.dragStart(),this.$el.classList.add("y-modal-graging"),this._panelInfo=this._getPanelInfo(),this._dragState=this._getDragState(s,i,!0),n=this._panelInfo.top,r=this._panelInfo.bottom-this._dragState.height,l=this._panelInfo.left,a=this._panelInfo.right-this._dragState.width,console.log(this._dragState,s.pageY,s.clientY,s);var u=function(e){var i=t.Uitls.isMobile()?e.targetTouches[0]:e;if(o._moveing){var s=o._dragState.startTop+(i.pageY-o._dragState.startMouseTop),u=o._dragState.startLeft+(i.pageX-o._dragState.startMouseLeft);s=(s=s<n?n:s)>r?r:s,u=(u=u<l?l:u)>a?a:u,o.$el.style.top=s+"px",o.$el.style.left=u+"px"}},c=function(e){o._moveing=!1,o._panelInfo=null,o._dragState=null,o.$el.classList.remove("y-modal-graging"),t.Uitls.dragStop(),t.Uitls.mousemove("off",document,u),t.Uitls.mouseup("off",document,c)};t.Uitls.mousemove("on",document,u),t.Uitls.mouseup("on",document,c)},o.prototype._mouseoverHandle=function(t){document.body.style.cursor="move"},o.prototype._removeCursorHandle=function(){document.body.style.cursor=""},o.prototype._dragEvent=function(){var e=this;t.Uitls.mousedown("on",this.$title,function(t){e._mousedownHandle(t)}),t.Uitls.on("mouseover",this.$title,this._mouseoverHandle),t.Uitls.on("mouseout",this.$title,this._removeCursorHandle),t.Uitls.on("mouseout",this.$el,this._removeCursorHandle)},o.prototype._closeEvent=function(){var e=this;this.$close&&t.Uitls.on("mouseup",this.$close,function(t){e.hide()})},o.prototype._winResize=function(){var e,o=this;t.Uitls.on("resize",window,function(){e&&clearTimeout(e),e=setTimeout(function(){o._setPosition()},100)})},o.prototype._changeResize=function(e){var o,i,s,n=this,l=this.$el.getBoundingClientRect(),r=t.Uitls.isMobile()?e.targetTouches[0]:e,a=0,u=0;t.Uitls.dragStart(),this._scaleing=!0,this._panelInfo=this._getPanelInfo(),this._dragState=this._getDragState(r,l,!0),this.$resizeWidthTarget||((s=this.$el.querySelector(".modal-dialog"))?(this.$resizeWidthTarget=s,s=null):this.$resizeWidthTarget=this.$el),this.$resizeHeightTarget||((s=this.$el.querySelector(".modal-body"))?(this.$resizeHeightTarget=s,s=null):this.$resizeWidthTarget=this.$el),o=this.$resizeWidthTarget.getBoundingClientRect(),i=this.$resizeHeightTarget.getBoundingClientRect(),a=this._panelInfo.right-o.left,u=this._panelInfo.bottom-i.top,o=o.width,i=i.height;var c=function(e){var s=t.Uitls.isMobile()?e.targetTouches[0]:e;if(n._scaleing){var l=o+(s.pageX-n._dragState.startMouseLeft),r=i+(s.pageY-n._dragState.startMouseTop);l=(l=l>a?a:l)<100?100:l,r=(r=r>u?u:r)<50?50:r,n.$resizeWidthTarget&&(n.$resizeWidthTarget.style.width=l+"px"),n.$resizeHeightTarget&&(n.$resizeHeightTarget.style.height=r+"px")}},h=function(e){n._scaleing=!1,n._panelInfo=null,n._dragState=null,t.Uitls.dragStop(),t.Uitls.mousemove("off",document,c),t.Uitls.mouseup("off",document,h)};t.Uitls.mousemove("on",document,c),t.Uitls.mouseup("on",document,h)},o.prototype._createResize=function(){var e=this,o=document.createElement("em");o.classList.add("y-modal-btn-resize"),this.$el.appendChild(o),t.Uitls.mousedown("on",o,function(t){e._changeResize(t)})},o.prototype._bindEvent=function(){this._createResize(),this._dragEvent(),this._winResize(),this._closeEvent()},o.prototype.destroy=function(){this.$el=null,this.$panel=null,this.$title=null,this.$close=null,this._panelInfo=null,this._dragState=null,document.body.style.cursor=""},o}(t.AbstractModal);t.Modal=e}($y||($y={}));
//# sourceMappingURL=modal.min.js.map
